<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>WebSocket Ê∏¨Ë©¶</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        #log {
            background: #252526;
            padding: 15px;
            border-radius: 5px;
            max-height: 600px;
            overflow-y: auto;
        }
        .entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #007acc;
        }
        .error {
            border-left-color: #f48771;
        }
        .success {
            border-left-color: #4ec9b0;
        }
        h1 {
            color: #4ec9b0;
        }
    </style>
</head>
<body>
    <h1>WebSocket ÈÄ£Êé•Ê∏¨Ë©¶</h1>
    <div id="log"></div>
    
    <script>
        const logDiv = document.getElementById('log');
        
        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        log('ÈñãÂßãÈÄ£Êé• WebSocket...', 'info');
        
        const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
        const wsUrl = `${protocol}//${window.location.host}/ws`;
        
        log(`ÈÄ£Êé•Âà∞: ${wsUrl}`, 'info');
        
        const ws = new WebSocket(wsUrl);
        
        ws.onopen = () => {
            log('‚úÖ WebSocket ÈÄ£Êé•ÊàêÂäüÔºÅ', 'success');
        };
        
        ws.onmessage = (event) => {
            try {
                const data = JSON.parse(event.data);
                log(`üì• Êî∂Âà∞Êï∏Êìö:`, 'success');
                log(`  - ÈÅãË°åÊôÇÈñì: ${Math.floor(data.uptime)}Áßí`, 'info');
                log(`  - TCP ÈÄ£Êé•: ${data.stats.tcp_connections}`, 'info');
                log(`  - HTTP Ë´ãÊ±Ç: ${data.stats.http_requests}`, 'info');
                log(`  - UDP Â∞ÅÂåÖ: ${data.stats.udp_packets}`, 'info');
                log(`  - ICMP Â∞ÅÂåÖ: ${data.stats.icmp_packets}`, 'info');
                log(`  - ÊîªÊìäÈ°ûÂûãÊï∏: ${Object.keys(data.attack_types).length}`, 'info');
                log(`  - ÊîªÊìä‰∫ã‰ª∂Êï∏: ${data.recent_attacks.length}`, 'info');
                if (data.system) {
                    log(`  - CPU: ${data.system.cpu.toFixed(1)}%`, 'info');
                    log(`  - Ë®òÊÜ∂È´î: ${data.system.memory.toFixed(1)}%`, 'info');
                }
                log('---', 'info');
            } catch (e) {
                log(`‚ùå Ëß£ÊûêÈåØË™§: ${e.message}`, 'error');
                log(`ÂéüÂßãÊï∏Êìö: ${event.data.substring(0, 100)}...`, 'error');
            }
        };
        
        ws.onerror = (error) => {
            log(`‚ùå WebSocket ÈåØË™§: ${error}`, 'error');
        };
        
        ws.onclose = () => {
            log('‚ùå WebSocket ÈÄ£Êé•ÈóúÈñâ', 'error');
        };
    </script>
</body>
</html>
